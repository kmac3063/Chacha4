(this["webpackJsonpmini-app"]=this["webpackJsonpmini-app"]||[]).push([[0],{147:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n(40),a=n.n(s),r=n(22),i=n.n(r),o=n(13),l=n.n(o),u=n(20),d=n(21),j=n(9),h=(n(145),n(33)),b=n(7),f=function(e){var t=e.id,n=e.go,s=e.fetchedUser,a=(e.scheme,e.host),r=e.status,o=e.db,l=Object(c.useState)(0),u=Object(d.a)(l,2),f=u[0],p=u[1],O=Object(c.useState)(null),g=Object(d.a)(O,2),x=g[0],v=g[1],m=Object(c.useState)("00000000P"),S=Object(d.a)(m,2),y=S[0],I=S[1];Object(c.useEffect)((function(){var e=null;if("connect"===r){if(null===a)return;console.log(a);var t=Object(h.a)(o,"hs",a.id.toString());e=setInterval((function(){Object(h.b)(t).then((function(e){e.exists()&&(console.log("snap.data().stateString: "+e.data().stateString),I((function(){return e.data().stateString})))}))}),100)}return function(){null!==e&&clearInterval(e),"host"===r&&null!==s&&Object(h.d)(Object(h.a)(o,"hs",s.id.toString()),{stateString:y.slice(0,8)+"P"}),I((function(e){return e.slice(0,8)+"P"})),clearInterval(x),i.a.send("VKWebAppFlashSetLevel",{level:0})}}),[]),Object(c.useEffect)((function(){console.log("useEffect stateString:"+y),"host"===r&&null!==s&&Object(h.d)(Object(h.a)(o,"hs",s.id.toString()),{stateString:y}),clearInterval(x),"R"===y[y.length-1]?k():(p(0),i.a.send("VKWebAppFlashSetLevel",{level:0}))}),[y]);var C=function(e,t){I((function(t){var n=t.slice(0,e)+("1"===t[e]?"0":"1")+t.slice(e+1,8)+"P";return console.log(n),n}))},k=function(){var e=0;p(1),i.a.send("VKWebAppFlashSetLevel",{level:parseInt(y[0])});var t=setInterval((function(){p((function(e){return 1+e%8})),e=(e+1)%8,i.a.send("VKWebAppFlashSetLevel",{level:parseInt(y[e])})}),1e3);v(t)};return Object(b.jsxs)(j.i,{id:t,children:[Object(b.jsx)(j.j,{left:Object(b.jsx)(j.k,{onClick:n,"data-to":"Choose"}),children:"host"===r?"\u0414\u0438\u0434\u0436\u0435\u0439":"\u0421\u043b\u0443\u0448\u0430\u0442\u0435\u043b\u044c"}),"host"===r?Object(b.jsx)(j.g,{children:Object(b.jsxs)(j.f,{style:{display:"flex"},children:[Object(b.jsx)(j.d,{size:"l",stretched:!0,style:{marginRight:8},onClick:function(){I((function(e){return e.slice(0,8)+"R"}))},children:"\u041d\u0430\u0447\u0430\u0442\u044c"}),Object(b.jsx)(j.d,{size:"l",stretched:!0,mode:"secondary",onClick:function(){I((function(e){return e.slice(0,8)+"P"}))},children:"\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"})]})}):Object(b.jsxs)(j.g,{children:[Object(b.jsx)(j.h,{mode:"secondary",children:"\u041d\u0430\u0448 \u0434\u0438\u0434\u0436\u0435\u0439"}),Object(b.jsx)(j.e,{before:Object(b.jsx)(j.c,{src:null!==a?a.photo_200:""}),children:null!==a?a.first_name+" "+a.last_name:"..."})]}),Object(b.jsxs)(j.g,{children:[Object(b.jsx)(j.h,{mode:"secondary",children:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0443\u043d\u0434\u0430\u043c\u0438"}),Object(b.jsx)(j.f,{style:{display:"flex",justifyContent:"space-between",overflow:"auto"},children:y.split("").map((function(e,t){return"0"!==e&&"1"!==e?null:Object(b.jsxs)(j.f,{style:{padding:"0",backgroundColor:t+1===f?"#D7FDDB":"#FFFFFF"},children:[Object(b.jsxs)(j.f,{style:{padding:"0"},children:[t+1," \u0441\u0435\u043a"]}),"host"===r?Object(b.jsx)(j.n,{checked:"1"===e,onChange:function(e){return C(t,e.target.value)}}):Object(b.jsx)(j.n,{checked:"1"===e,disabled:!0,onChange:function(e){return C(t,e.target.value)}})]},t)}))})]}),Object(b.jsxs)(j.g,{children:[Object(b.jsx)(j.h,{mode:"secondary",children:"host"===r?"\u042d\u0442\u043e \u0432\u0430\u0448\u0430 \u043a\u043e\u043c\u043d\u0430\u0442\u0430":"\u0412\u044b \u0441\u043b\u0443\u0448\u0438\u0442\u0435\u043b\u044c"}),Object(b.jsx)(j.e,{multiline:!0,children:"host"===r?"\u0412\u0441\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0432\u0448\u0438\u0435\u0441\u044f \u043a \u0432\u0430\u043c \u043b\u044e\u0434\u0438 \u0431\u0443\u0434\u0443\u0442 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u0441\u0438\u0433\u043d\u0430\u043b \u043e \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u0444\u043e\u043d\u0430\u0440\u0438\u043a\u0430 \u0432 \u043e\u0434\u0438\u043d \u043c\u043e\u043c\u0435\u043d\u0442 \u0441 \u0432\u0430\u043c\u0438":"\u0416\u0434\u0438\u0442\u0435, \u043f\u043e\u043a\u0430 \u0432\u043b\u0430\u0434\u0435\u043b\u0435\u0446 \u043a\u043e\u043c\u043d\u0430\u0442\u044b \u0432\u043a\u043b\u044e\u0447\u0438\u0442 \u0432\u0430\u043c \u0444\u043e\u043d\u0430\u0440\u0438\u043a!"})]})]})},p=(n.p,n(148)),O=function(e){var t=e.id,n=(e.go,e.fetchedUser,e.scheme,e.connect),s=e.host;return Object(c.useEffect)((function(){console.log("Choose"),i.a.send("VKWebAppFlashSetLevel",{level:0})}),[]),Object(b.jsxs)(j.i,{id:t,children:[Object(b.jsx)(j.j,{children:"\u041e\u0434\u0438\u043d-\u043d\u043e\u043b\u044c \u0444\u043e\u043d\u0430\u0440\u0438\u043a"}),Object(b.jsx)(j.g,{children:Object(b.jsxs)(j.f,{style:{display:"flex"},children:[Object(b.jsx)(j.d,{size:"l",stretched:!0,style:{marginRight:8},onClick:n,"data-to":"Home",children:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f"}),Object(b.jsx)(j.d,{size:"l",stretched:!0,mode:"secondary",onClick:s,"data-to":"Home",children:"\u0411\u044b\u0442\u044c \u0434\u0438\u0434\u0436\u0435\u0435\u043c"})]})})]})},g=function(e){var t=e.id,n=(e.fetchedUser,e.go);return Object(b.jsx)(j.i,{id:t,children:Object(b.jsx)(j.g,{children:Object(b.jsx)(j.l,{icon:Object(b.jsx)(p.a,{}),header:"\u041f\u0440\u0438\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u043c, \u041f\u0440\u0438\u044f\u0442\u0435\u043b\u044c!",action:Object(b.jsx)(j.d,{size:"m",onClick:n,"data-to":"Choose",children:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0444\u043e\u043d\u0430\u0440\u0438\u043a\u0443"}),children:'\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043e \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u0445\u0430\u043a\u0430\u0442\u043e\u043d\u0430 "\u0412\u0435\u0437\u0434\u0435\u043a\u043e\u0434 2021"'})})})},x=n(54),v=function(){var e=Object(c.useState)("Choose"),t=Object(d.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(null),r=Object(d.a)(a,2),o=r[0],p=r[1],v=Object(c.useState)(Object(b.jsx)(j.m,{size:"large"})),m=Object(d.a)(v,2),S=m[0],y=m[1],I=Object(c.useState)(null),C=Object(d.a)(I,2),k=(C[0],C[1]),F=Object(c.useState)(null),A=Object(d.a)(F,2),K=A[0],W=A[1],U=Object(c.useState)("connect"),V=Object(d.a)(U,2),w=V[0],z=V[1],E=Object(x.a)({apiKey:"AIzaSyA4pTIWp427xU-6UKZhMS5gm7jgZpnjTaM",authDomain:"chacha4-45297.firebaseapp.com",projectId:"chacha4-45297",storageBucket:"chacha4-45297.appspot.com",messagingSenderId:"908778198952",appId:"1:908778198952:web:a3d68cc210e47a638aaf9d"}),P=Object(h.c)(E);Object(c.useEffect)((function(){function e(){return(e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(null),e.next=3,i.a.send("VKWebAppGetUserInfo");case 3:t=e.sent,p(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.a.send("VKWebAppFlashGetInfo").then((function(e){e.is_available||alert("\u041d\u0430 \u0432\u0430\u0448\u0435\u043c \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442/\u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0444\u043e\u043d\u0430\u0440\u0438\u043a :(")}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}i.a.subscribe((function(e){var t=e.detail,n=t.type;t.data;if("VKWebAppUpdateConfig"===n){var c=document.createAttribute("scheme");c.value="client_light",k(c.value),document.body.attributes.setNamedItem(c)}})),function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}()}),[]);var H=function(e){s(e.currentTarget.dataset.to)};return Object(b.jsx)(j.a,{children:Object(b.jsx)(j.b,{children:Object(b.jsxs)(j.o,{activePanel:n,popout:S,children:[Object(b.jsx)(g,{id:"WelcomeScreen",fetchedUser:o,go:H}),Object(b.jsx)(O,{id:"Choose",fetchedUser:o,go:H,connect:function(){i.a.send("VKWebAppGetFriends",{}).then((function(e){W((function(){return e.users[0]})),z("connect"),s((function(){return"Home"}))}))},host:function(){z("host"),s((function(){return"Home"})),W((function(){return null}))}}),Object(b.jsx)(f,{id:"Home",fetchedUser:o,go:H,host:K,status:w,db:P})]})})})};i.a.send("VKWebAppInit"),a.a.render(Object(b.jsx)(v,{}),document.getElementById("root"))}},[[147,1,2]]]);
//# sourceMappingURL=main.83eee858.chunk.js.map